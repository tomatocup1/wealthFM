import"./supabaseClient-CAAA46mf.js";class n{constructor(){this.userInfo=null,this.currentStore="all",this.currentPlatform="all",this.currentDate=new Date}async initializePage(){try{if(this.userInfo=this.checkSession(),!this.userInfo)return;this.setupRole(),this.setupNavigation(),this.setupEventListeners()}catch(e){console.error("페이지 초기화 실패:",e)}}checkSession(){const e=sessionStorage.getItem("userInfo");return e?JSON.parse(e):(window.location.href="login.html",null)}setupRole(){const e=document.getElementById("roleSelect");e&&(e.value=this.userInfo.role,e.disabled=!0)}setupNavigation(){const e=document.getElementById("navMenu");if(!e)return;let t='<a href="layout.html" class="nav-link active">리뷰 모아보기</a>';switch(this.userInfo.role){case"webmaster":t+=`
                    <a href="customer_data.html" class="nav-link">고객 데이터 관리</a>
                    <a href="error_logs.html" class="nav-link">에러 로그</a>
                    <a href="admin_management.html" class="nav-link">관리자 관리</a>
                `;break;case"admin":t+=`
                    <a href="customer_data.html" class="nav-link">고객 데이터 관리</a>
                `;break}e.innerHTML=t,this.highlightCurrentPage()}highlightCurrentPage(){const e=window.location.pathname.split("/").pop();document.querySelectorAll(".nav-link").forEach(t=>{t.getAttribute("href")===e?t.classList.add("active"):t.classList.remove("active")})}setupEventListeners(){document.querySelectorAll(".platform-tab").forEach(t=>{t.addEventListener("click",a=>{this.handlePlatformChange(a.target.dataset.platform)})});const e=document.getElementById("storeSelect");e&&e.addEventListener("change",t=>{this.handleStoreChange(t.target.value)}),document.querySelectorAll("#calendarBody td[data-date]").forEach(t=>{t.addEventListener("click",a=>{this.handleDateSelection(a.target)})})}handlePlatformChange(e){document.querySelectorAll(".platform-tab").forEach(t=>{t.classList.toggle("active",t.dataset.platform===e)}),this.currentPlatform=e,this.updateReviewDisplay()}handleStoreChange(e){this.currentStore=e,this.updateReviewDisplay()}handleDateSelection(e){document.querySelectorAll(".calendar td.selected").forEach(a=>{a.classList.remove("selected")}),e.classList.add("selected");const t=new Date(this.currentDate.getFullYear(),this.currentDate.getMonth(),parseInt(e.dataset.date));this.currentDate=t,this.updateReviewDisplay()}async updateReviewDisplay(){window.reviewDashboard&&window.reviewDashboard.updateFilters({store:this.currentStore,platform:this.currentPlatform,date:this.currentDate})}}document.addEventListener("DOMContentLoaded",()=>{const r=new n;r.initializePage(),window.pageManager=r});
